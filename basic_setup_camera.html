<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="css/basic.css">

  <title>Beyond Reality Face SDK - BRFv5 - Browser/Javascript - basic setup: camera</title>

  <!-- These three scripts are optional. -->
  <script src="./js/utils/BRFv5SimpleResize.js"></script>
  <script src="./js/utils/BRFv5SimplePreloader.js"></script>
  <script src="./js/utils/BRFv5SimpleStats.js"></script>

  <!-- For a real time face tracking you need to activate the camera and a canvas -->
  <script src="./js/utils/BRFv5Camera.js"></script>
  <script src="./js/utils/BRFv5Canvas.js"></script>

  <!-- Init includes the loading, initialization, basic configuration and tracking interval. -->
  <script src="./js/utils/BRFv5BasicInit.js"></script>

  <!-- Each of these examples include an example specific tracking function and, if necessary, a custom configuration. -->
  <!-- Choose only one file at a time. -->

  <script src="./js/examples/basic__face_detection__example.js"></script>
<!--  <script src="./js/examples/basic__face_tracking__single_face.js"></script>-->
<!--  <script src="./js/examples/basic__face_tracking__multiple_faces.js"></script>-->

  <script>

    const onLoadedBRFv5   = async () => {

      // Optional: A loading bar for model loading progress.
      if(typeof setupPreloader === "function") setupPreloader(document.body);

      // Simultaneously start the camera and load the model.

      // While higher resolutions are possible they are need more processing time.

      const cameraPromise = startCamera({ width:  640, height:  480, frameRate: 30 });
      // const cameraPromise = startCamera({ width: 1280, height:  720, frameRate: 30 });
      // const cameraPromise = startCamera({ width: 1920, height: 1080, frameRate: 30 });

      // Load the model and set your appId.
      const brfv5Promise  = initBRFv5("com.tastenkunst.examples.browser.camera", "BRFv5_JS_tk170619_v5.0.0a_trial_68l_max");

      const states        = await Promise.all([cameraPromise, brfv5Promise]);

      const cameraData    = states[0]; // returns resolution, video
      const isBRFv5Ready  = states[1]; // returns _brfv5Manager, _brfv5Config

      if(cameraData && isBRFv5Ready) {

        // Basic config:
        //   brfv5Manager (API functions)
        //   brfv5Config  (parameters)
        //   resolution   (width, height)
        configureExample(isBRFv5Ready._brfv5Manager, isBRFv5Ready._brfv5Config, cameraData.width, cameraData.height);

        // Track a face in a camera video, give it a canvas to draw the video image data and results to.
        startTracking(trackExample, cameraData.video, setupCanvas(cameraData.width, cameraData.height, document.body), false);

        // Optional: Show 1 seconds average processing time.
        if(typeof setupStats === "function") setupStats(document.body);
      }
    };

  </script>

  <script async onload="onLoadedBRFv5()" type="text/javascript" src="./js/brfv5/BRFv5_JS_tk170619_v5.0.0a_trial.js"></script>

</head>

<body>

<a href="https://www.beyond-reality-face.com" target="_blank" style="width: 128px; height: 128px">
  <img src="images/brfv5_logo.png" alt="brfv5 logo" style="width: 128px; height: 128px">
</a>

</body>

</html>